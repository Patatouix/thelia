{*
A generic pager for thelia back-office

Parameters :

$loop_ref: the name of the related loop
$max_page_count : maximum number of pages to display
$page_url : the URL of the page. The parameter page=x is appended to this URL.

*}

{* Prepare the URL so that the page=x parameter coumd be safely appended *}

{if strpos($page_url, '?')}
    {$page_url="$page_url&"}
{else}
    {$page_url="$page_url?"}
{/if}

{if !$page_param_name}
    {assign var="page_param_name" value="page"}
{/if}

<div class="text-center">
    <ul class="pagination pagination-centered justify-content-center">
        {pageloop rel=$loop_ref limit=$max_page_count}
            {$prev_page = $PREV}
            {$next_page = $NEXT}
            {$last_page = $LAST}
            {$has_prev  = $CURRENT > 1}
            {$has_next  = $CURRENT < $LAST}

            {$has_pages_after = $END < $LAST && $LAST > $max_page_count}
            {$has_pages_before = $START > 1}

            {if $PAGE == $START}
                {if $has_prev}
                    <li class="page-item"><a title="{intl l="Go to first page"}" href="{$page_url nofilter}{$page_param_name}=1" class="page-link">&laquo;</a></li>
                    <li class="page-item"><a title="{intl l="Go to previous page"}" href="{$page_url nofilter}{$page_param_name}={$prev_page}" class="page-link">&lsaquo;</a></li>

                    {if $has_pages_before}
                        <li title="{intl l="More pages before"}" class="page-item disabled"><a href="#" class="page-link">&hellip;</a></li>
                    {/if}

                {else}
                    <li class="page-item disabled"><a href="#" class="page-link">&laquo;</a></li>
                    <li class="page-item disabled"><a href="#" class="page-link">&lsaquo;</a></li>
                {/if}
            {/if}

            {if $PAGE != $CURRENT}
                <li class="page-item"><a href="{$page_url nofilter}{$page_param_name}={$PAGE}" class="page-link">{$PAGE}</a></li>
            {else}
                <li class="page-item active"><a href="#" class="page-link">{$PAGE}</a></li>
            {/if}

            {if $PAGE == $END}
                {if $has_next}
                    {if $has_pages_after}
                        <li title="{intl l="More pages after"}" class="page-item disabled"><a href="#" class="page-link">&hellip;</a></li>
                    {/if}

                    <li class="page-item"><a title="{intl l="Go to next page"}" href="{$page_url nofilter}{$page_param_name}={$next_page}" class="page-link">&rsaquo;</a></li>
                    <li class="page-item"><a title="{intl l="Go to last page"}" href="{$page_url nofilter}{$page_param_name}={$last_page}" class="page-link">&raquo;</a></li>

                {else}
                    <li class="page-item disabled"><a href="#" class="page-link">&rsaquo;</a></li>
                    <li class="page-item disabled"><a href="#" class="page-link">&raquo;</a></li>
                {/if}
            {/if}
        {/pageloop}
    </ul>
</div>
